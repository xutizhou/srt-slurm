name: "agg-tp-h200-fp8-mtp"

model:
  path: "dsfp8"
  container: "lmsysorg/sglang:v0.5.8-cu130-runtime"
  precision: "fp8"

resources:
  gpu_type: "h200"
  agg_nodes: 1
  agg_workers: 1
  gpus_per_node: 8

backend:

  # Aggregated environment variables
  aggregated_environment:
    SGLANG_ENABLE_SPEC_V2: "1"
    SGLANG_JIT_DEEPGEMM_FAST_WARMUP: "1"
    SGLANG_DISAGGREGATION_HEARTBEAT_MAX_FAILURE: "100000"
    SGLANG_DISAGGREGATION_BOOTSTRAP_TIMEOUT: "100000"
    SGLANG_DISAGGREGATION_WAITING_TIMEOUT: "100000"

  sglang_config:
    aggregated:
      # Model configuration
      served-model-name: "deepseek-ai/DeepSeek-R1"
      model-path: "/model/"
      skip-tokenizer-init: true
      trust-remote-code: true
      watchdog-timeout: 1000000

      # Parallelism
      tp-size: 8
      dp-size: 1

      # KV cache and attention
      attention-backend: "flashinfer"

      # Radix cache disabled
      disable-radix-cache: true

      # Other flags
      stream-interval: 10
      max-running-requests: 128  # sum of all dp

      # Memory and token limits
      mem-fraction-static: 0.75
      max-prefill-tokens: 32768
      chunked-prefill-size: 32768

      # CUDA graphs
      cuda-graph-max-bs: 128

      # MTP settings
      speculative-algorithm: "EAGLE"
      speculative-num-steps: 2
      speculative-eagle-topk: 1
      speculative-num-draft-tokens: 3

benchmark:
  type: "sa-bench"
  isl: 1024
  osl: 1024
  concurrencies: "1x4x16x32x64x128x256x512"
  req_rate: "inf"
